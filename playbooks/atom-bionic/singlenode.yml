---
- hosts: "atom-local"

  pre_tasks:

    - include_vars: "vars-singlenode-qa.yml"
      tags:
        - "always"

    - name: "Install php-cli (required to install Composer)"
      apt:
        pkg: "php-cli"
        state: "latest"
        update_cache: "yes"
        cache_valid_time: "3600"
      become: true
      tags:
        - "composer"

  roles:

    - role: "artefactual.elasticsearch"
      become: "yes"
      tags:
        - "elasticsearch"

    - role: "artefactual.percona"
      become: "yes"
      tags:
        - "percona"

    - role: "artefactual.memcached"
      become: "yes"
      tags:
        - "memcached"

    - role: "artefactual.gearman"
      become: "yes"
      tags:
        - "gearman"

    - role: "artefactual.nginx"
      become: "yes"
      tags:
        - "nginx"

    - role: "geerlingguy.composer"
      become: "yes"
      tags:
        - "composer"

    - role: "artefactual.atom"
      become: "yes"
      tags:
        - "atom"
